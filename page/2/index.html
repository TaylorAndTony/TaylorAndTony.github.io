<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords"><meta name="author" content="TaylorAndTony,undefined"><meta name="copyright" content="TaylorAndTony"><title>【Hexo】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script><!-- link(rel="dns-prefetch" href="https://cdn.jsdelivr.net")--><!-- link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css")--><!-- script(src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer)--><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- script(src=url_for("/js/mathjax/mathjax.js"))--><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"2J9NCG4VA1","apiKey":"e2286fef4db1fed3731c0afa0c68d9ed","indexName":"hexo","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  gitment: {},
  valine: {},
  twikoo: {},
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="author-info"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">TaylorAndTony</div><div class="author-info-description"></div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/TaylorAndTony" target="_blank">GitHub<i class="icon-dot bg-color5"></i></a><a class="links-button button-hover" href="mailto:doyijian@163.com" target="_blank">E-Mail<i class="icon-dot bg-color2"></i></a><a class="links-button button-hover" href="https://space.bilibili.com/47256272" target="_blank">Bilibili<i class="icon-dot bg-color1"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">32</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">53</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">10</span></a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="search social-icon"><i class="fas fa-search"></i><span> 搜索</span></a><a class="title-name" href="/">Hexo</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><div id="recent-posts"><!-- each post in page.posts.sort('date', -1).limit(10).toArray()--><!-- config中配置按照什么排序--><div class="recent-post-item"><a class="post-title" href="/2025/01/25/windows-delete-file-err/">Win10 删除文件显示找不到该项目</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2025-01-25</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/software/">software</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/microsoft/">microsoft</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/troubleshoot/">troubleshoot</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/windows/">windows</a></div></div><div class="post-content"><div class="main-content content"><h1 id="Win10-删除一个文件显示找不到该项目"><a href="#Win10-删除一个文件显示找不到该项目" class="headerlink" title="Win10 删除一个文件显示找不到该项目"></a>Win10 删除一个文件显示<code>找不到该项目</code></h1><p>现象：在 explorer 中，选中一个文件，按下 <code>Shift+Delete</code>，弹窗提示<code>找不到该项目</code>。在此目录下使用 <code>dir</code> 命令，可以看到文件存在。</p>
<h2 id="用批处理"><a href="#用批处理" class="headerlink" title="用批处理"></a>用批处理</h2><p>打开空白文档，输入以下内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DEL /F /A /Q \\?\%1</span><br><span class="line">RD /S /Q \\?\%1</span><br></pre></td></tr></table></figure>

<p>将文本文档另存为 .bat 文件</p>
<p>将需要删除的文件夹拖拽到 bat 批处理文件上即可完成删除</p>
<h2 id="用git-bash"><a href="#用git-bash" class="headerlink" title="用git bash"></a>用git bash</h2><p>输入命令 <code>rm -rf 文件名</code></p>
<h2 id="放文件"><a href="#放文件" class="headerlink" title="放文件"></a>放文件</h2><p>在文件夹内放一个文件，再删除文件夹</p>
</div></div><a class="button-hover more" href="/2025/01/25/windows-delete-file-err/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2025/01/25/csharp-open-url/">C# 打开网址</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2025-01-25</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/csharp/">csharp</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/csharp/">csharp</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/microsoft/">microsoft</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/dotnet/">dotnet</a></div></div><div class="post-content"><div class="main-content content"><h1 id="C-打开网址-Process-Start-for-URLs-txt"><a href="#C-打开网址-Process-Start-for-URLs-txt" class="headerlink" title="C# 打开网址 Process Start for URLs.txt"></a>C# 打开网址 Process Start for URLs.txt</h1><p>Apparently .NET Core is sort of broken when it comes to opening a URL via <code>Process.Start</code>. Normally you’d expect to do this:</p>
<p><code>Process.Start(&quot;http://google.com&quot;)</code><br>And then the default system browser pops open and you’re good to go. But this open issue explains that this doesn’t work on .NET Core. So instead you have to do this (credit goes to Eric Mellino):</p>
<h2 id="solution-1-tested"><a href="#solution-1-tested" class="headerlink" title="solution 1 (tested)"></a>solution 1 (tested)</h2><p>use simple one</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Process.Start(<span class="keyword">new</span> ProcessStartInfo() </span><br><span class="line">              &#123;</span><br><span class="line">                  FileName = <span class="string">&quot;cmd&quot;</span>,</span><br><span class="line">                  Arguments = <span class="string">&quot;/c start &quot;</span> + url,</span><br><span class="line">                  UseShellExecute = <span class="literal">false</span>,</span><br><span class="line">                  WindowStyle = ProcessWindowStyle.Hidden,</span><br><span class="line">                  CreateNoWindow = <span class="literal">true</span>,</span><br><span class="line">              &#125;);</span><br></pre></td></tr></table></figure>

<p>or the long one</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OpenBrowser</span>(<span class="params"><span class="built_in">string</span> url</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        Process.Start(url);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// hack because of this: https://github.com/dotnet/corefx/issues/10361</span></span><br><span class="line">        <span class="keyword">if</span> (RuntimeInformation.IsOSPlatform(OSPlatform.Windows))</span><br><span class="line">        &#123;</span><br><span class="line">            url = url.Replace(<span class="string">&quot;&amp;&quot;</span>, <span class="string">&quot;^&amp;&quot;</span>);</span><br><span class="line">            Process.Start(<span class="keyword">new</span> ProcessStartInfo(<span class="string">&quot;cmd&quot;</span>, <span class="string">$&quot;/c start <span class="subst">&#123;url&#125;</span>&quot;</span>) &#123; CreateNoWindow = <span class="literal">true</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (RuntimeInformation.IsOSPlatform(OSPlatform.Linux))</span><br><span class="line">        &#123;</span><br><span class="line">            Process.Start(<span class="string">&quot;xdg-open&quot;</span>, url);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (RuntimeInformation.IsOSPlatform(OSPlatform.OSX))</span><br><span class="line">        &#123;</span><br><span class="line">            Process.Start(<span class="string">&quot;open&quot;</span>, url);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="solution-2-tested"><a href="#solution-2-tested" class="headerlink" title="solution 2 (tested)"></a>solution 2 (tested)</h2><p>This was an intentional breaking change in .Net Core. Specifically, <code>UseShellExecute</code>, which is required to be <code>true</code> for your code to work, <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.processstartinfo.useshellexecute">defaults to <code>true</code> on .Net Framework, but it’s <code>false</code> on .Net Core</a>. This means the following code will work on both frameworks:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Process.Start(<span class="keyword">new</span> ProcessStartInfo(<span class="string">&quot;https://www.google.com&quot;</span>) &#123; UseShellExecute = <span class="literal">true</span> &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="solution-3"><a href="#solution-3" class="headerlink" title="solution 3"></a>solution 3</h2><p><strong><a target="_blank" rel="noopener" href="https://github.com/dsplaisted">dsplaisted</a></strong> commented <a target="_blank" rel="noopener" href="https://github.com/dotnet/runtime/issues/28005#issuecomment-442214248">on Nov 28, 2018</a></p>
<p>I believe the currently recommended workaround is to set <code>UseShellExecute</code> to true:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ProcessStartInfo psi = <span class="keyword">new</span> ProcessStartInfo</span><br><span class="line">&#123;</span><br><span class="line">    FileName = url,</span><br><span class="line">    UseShellExecute = <span class="literal">true</span></span><br><span class="line">&#125;;</span><br><span class="line">Process.Start (psi);</span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://github.com/clairernovotny">clairernovotny</a></strong> commented <a target="_blank" rel="noopener" href="https://github.com/dotnet/runtime/issues/28005#issuecomment-442214640">on Nov 28, 2018</a> • edited </p>
<p>You need this instead</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ProcessStartInfo psi = <span class="keyword">new</span> ProcessStartInfo</span><br><span class="line">&#123;</span><br><span class="line">    FileName = <span class="string">&quot;cmd&quot;</span>,</span><br><span class="line">    Arguments = <span class="string">&quot;/c start https://www.baidu.com/s?wd=beijing%20time&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line">Process.Start(psi);</span><br></pre></td></tr></table></figure>

<p>Which is ugly…and more likely to bite people, I think.</p>
<p><strong><a target="_blank" rel="noopener" href="https://github.com/clairernovotny">clairernovotny</a></strong> commented <a target="_blank" rel="noopener" href="https://github.com/dotnet/runtime/issues/28005#issuecomment-442217271">on Nov 28, 2018</a></p>
<p>Actually it’s worse than that, here’s what you need to do it right <strong>so no cmd window appears</strong>:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> psi = <span class="keyword">new</span> ProcessStartInfo</span><br><span class="line">&#123;</span><br><span class="line">    FileName = <span class="string">&quot;cmd&quot;</span>,</span><br><span class="line">    WindowStyle = ProcessWindowStyle.Hidden,</span><br><span class="line">    UseShellExecute = <span class="literal">false</span>,</span><br><span class="line">    CreateNoWindow = <span class="literal">true</span>,</span><br><span class="line">    Arguments = <span class="string">$&quot;/c start <span class="subst">&#123;link.AbsoluteUri&#125;</span>&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line">Process.Start(psi);</span><br></pre></td></tr></table></figure>

</div></div><a class="button-hover more" href="/2025/01/25/csharp-open-url/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2025/01/25/csharp-images/">C# bitmap 图片编码及压缩参数</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2025-01-25</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/csharp/">csharp</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/csharp/">csharp</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/microsoft/">microsoft</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/dotnet/">dotnet</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/cv/">cv</a></div></div><div class="post-content"><div class="main-content content"><h1 id="C-bitmap图片编码及压缩参数"><a href="#C-bitmap图片编码及压缩参数" class="headerlink" title="C# bitmap图片编码及压缩参数"></a>C# bitmap图片编码及压缩参数</h1><h2 id="读取图片"><a href="#读取图片" class="headerlink" title="读取图片"></a>读取图片</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Image img = Image.FromFile(imgFile);</span><br></pre></td></tr></table></figure>

<h2 id="ImageCodecInfo-帮助方法"><a href="#ImageCodecInfo-帮助方法" class="headerlink" title="ImageCodecInfo 帮助方法"></a>ImageCodecInfo 帮助方法</h2><p>简写：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> ImageCodecInfo <span class="title">GetEncoder</span>(<span class="params">ImageFormat format</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> codecs = ImageCodecInfo.GetImageDecoders();</span><br><span class="line">    <span class="keyword">return</span> codecs.FirstOrDefault(codec =&gt; codec.FormatID == format.Guid);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>原始</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> ImageCodecInfo <span class="title">GetEncoder</span>(<span class="params">ImageFormat format</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    ImageCodecInfo[] codecs = ImageCodecInfo.GetImageEncoders();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (ImageCodecInfo codec <span class="keyword">in</span> codecs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (codec.FormatID == format.Guid)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> codec;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="编码及压缩"><a href="#编码及压缩" class="headerlink" title="编码及压缩"></a>编码及压缩</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Bitmap target = <span class="keyword">new</span> Bitmap(width, height);</span><br><span class="line"></span><br><span class="line"><span class="comment">// format and encoder</span></span><br><span class="line"><span class="comment">// the format is used by the encoder</span></span><br><span class="line"><span class="comment">// to generate ImageCodecInfo</span></span><br><span class="line">ImageFormat format = ImageFormat.Jpeg;</span><br><span class="line">ImageCodecInfo encoder = GetEncoder(format);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Bitmap.Save takes the EncoderParameters,</span></span><br><span class="line"><span class="comment">// but what we make is a EncoderParameter, no &quot;s&quot; at the end.</span></span><br><span class="line"><span class="comment">// use EncoderParameters.Param[0] to assign</span></span><br><span class="line">EncoderParameters pm = <span class="keyword">new</span> EncoderParameters(<span class="number">1</span>);</span><br><span class="line">pm.Param[<span class="number">0</span>] = <span class="keyword">new</span> EncoderParameter(Encoder.Quality, <span class="number">80L</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> filename = ...</span><br><span class="line">target.Save(filename, encoder, pm);</span><br></pre></td></tr></table></figure>

<h2 id="附：裁剪图片"><a href="#附：裁剪图片" class="headerlink" title="附：裁剪图片"></a>附：裁剪图片</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Rectangle cropRect = <span class="keyword">new</span> Rectangle(x, y, width, height);</span><br><span class="line"></span><br><span class="line">Bitmap target = <span class="keyword">new</span> Bitmap(width, height);</span><br><span class="line">Graphics g = Graphics.FromImage(target);</span><br><span class="line">g.DrawImage(img, </span><br><span class="line">            <span class="keyword">new</span> Rectangle(<span class="number">0</span>, <span class="number">0</span>, target.Width, target.Height),</span><br><span class="line">            cropRect,</span><br><span class="line">            GraphicsUnit.Pixel);</span><br></pre></td></tr></table></figure>

</div></div><a class="button-hover more" href="/2025/01/25/csharp-images/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2025/01/25/csharp-popups/">C# 弹窗获取文件等</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2025-01-25</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/csharp/">csharp</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/csharp/">csharp</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/microsoft/">microsoft</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/dotnet/">dotnet</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/wpf/">wpf</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/winform/">winform</a></div></div><div class="post-content"><div class="main-content content"><h1 id="C-弹窗获取文件等"><a href="#C-弹窗获取文件等" class="headerlink" title="C#弹窗获取文件等"></a>C#弹窗获取文件等</h1><h2 id="Winform获取文件"><a href="#Winform获取文件" class="headerlink" title="Winform获取文件"></a>Winform获取文件</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文件选取 这里只允许txt文件</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button1_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    OpenFileDialog dialog = <span class="keyword">new</span> OpenFileDialog();</span><br><span class="line">    dialog.Multiselect = <span class="literal">false</span>;   <span class="comment">//是否允许多选</span></span><br><span class="line">    dialog.Title = <span class="string">&quot;请选择要处理的文件&quot;</span>;  <span class="comment">//窗口title</span></span><br><span class="line">    dialog.Filter = <span class="string">&quot;文本文件(*.txt)|*.*&quot;</span>;   <span class="comment">//可选择的文件类型</span></span><br><span class="line">    <span class="keyword">if</span> (dialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> path = dialog.FileName;  <span class="comment">//获取文件路径</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Winform另存为"><a href="#Winform另存为" class="headerlink" title="Winform另存为"></a>Winform另存为</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SaveFileDialog savedialog = <span class="keyword">new</span> SaveFileDialog();</span><br><span class="line">savedialog.Filter = <span class="string">&quot;Jpg 图片|*.jpg|Bmp 图片|*.bmp|Gif 图片|*.gif|Png 图片|*.png|Wmf  图片|*.wmf&quot;</span>;</span><br><span class="line">savedialog.FilterIndex = <span class="number">0</span>;</span><br><span class="line">savedialog.RestoreDirectory = <span class="literal">true</span>;<span class="comment">//保存对话框是否记忆上次打开的目录</span></span><br><span class="line">savedialog.CheckPathExists = <span class="literal">true</span>;<span class="comment">//检查目录</span></span><br><span class="line">savedialog.FileName = System.DateTime.Now.ToString(<span class="string">&quot;yyyyMMddHHmmss&quot;</span>) + <span class="string">&quot;-&quot;</span>; ;<span class="comment">//设置默认文件名</span></span><br><span class="line"><span class="keyword">if</span> (savedialog.ShowDialog() == DialogResult.OK)</span><br><span class="line">&#123;</span><br><span class="line">    image.Save(savedialog.FileName, System.Drawing.Imaging.ImageFormat.Jpeg);<span class="comment">// image为要保存的图片</span></span><br><span class="line">    MessageBox.Show(<span class="keyword">this</span>, <span class="string">&quot;图片保存成功！&quot;</span>, <span class="string">&quot;信息提示&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="WPF获取文件-Win32"><a href="#WPF获取文件-Win32" class="headerlink" title="WPF获取文件(Win32)"></a>WPF获取文件(Win32)</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Microsoft.Win32.OpenFileDialog</span></span><br><span class="line"><span class="keyword">using</span> Microsoft.Win32;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ButtonBase_OnClick</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> openFileDialog = <span class="keyword">new</span> OpenFileDialog();</span><br><span class="line">    <span class="keyword">if</span> (openFileDialog.ShowDialog() == <span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// do something with the filename</span></span><br><span class="line">        MessageBox.Show(openFileDialog.FileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You can also specify a filter, which will show only certain type of files, like this:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> openFileDialog = <span class="keyword">new</span> OpenFileDialog</span><br><span class="line">&#123;</span><br><span class="line">    Filter = <span class="string">&quot;Text files (*.txt)|*.txt|All files (*.*)|*.*&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="WPF另存为"><a href="#WPF另存为" class="headerlink" title="WPF另存为"></a>WPF另存为</h2><p>SaveFileDialog类位于PresentationFramework.dll 的Microsoft.Win32命名空间</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ChooseSaveFile</span>(<span class="params"><span class="built_in">string</span> title,<span class="built_in">string</span> initFolder</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    SaveFileDialog dlg = <span class="keyword">new</span> SaveFileDialog();</span><br><span class="line">    dlg.Title = title;</span><br><span class="line">    dlg.FileName = <span class="string">&quot;User.txt&quot;</span>; <span class="comment">// Default file name</span></span><br><span class="line">    dlg.DefaultExt = <span class="string">&quot;.txt&quot;</span>; <span class="comment">// Default file extension</span></span><br><span class="line">    dlg.Filter = <span class="string">&quot;Text documents|*.txt&quot;</span>; <span class="comment">// Filter files by extension</span></span><br><span class="line">    dlg.InitialDirectory = initFolder;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Process save file dialog box results</span></span><br><span class="line">    <span class="keyword">if</span> (dlg.ShowDialog() == <span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> dlg.FileName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="通用获取文件夹-Ookii"><a href="#通用获取文件夹-Ookii" class="headerlink" title="通用获取文件夹(Ookii)"></a>通用获取文件夹(Ookii)</h2><p>Another typical case is when you need the user to select a folder. This time a File Dialog won’t do the job and you’ll need something different. If you’ve ever used WinForms you’d probably know FolderBrowserDialog class. Unfortunately this is not available in WPF by default, but don’t worry, you can still solve this in at least 3 different ways:</p>
<ol>
<li>Add the System.Windows.Forms DLL and use the FolderBrowserDialog class</li>
<li>Install the <a target="_blank" rel="noopener" href="https://www.nuget.org/packages/Ookii.Dialogs/">Ookii.Dialogs nuget</a> and use the VistaFolderBrowserDialog class</li>
<li>Install the <a target="_blank" rel="noopener" href="https://www.nuget.org/packages/Microsoft.WindowsAPICodePack-Shell">Windows API Code Pack-Shell</a> and use the CommonOpenFileDialog class</li>
</ol>
<p>The one I use the most is the Ookii.Dialogs one which looks easier and simpler to me. Just use this snippet and you’re ready to go:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ButtonBase2_OnClick</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> ookiiDialog = <span class="keyword">new</span> VistaFolderBrowserDialog();</span><br><span class="line">    <span class="keyword">if</span> (ookiiDialog.ShowDialog() == DialogResult.OK)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// do something with the folder path</span></span><br><span class="line">        MessageBox.Show(ookiiDialog.SelectedPath);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></div><a class="button-hover more" href="/2025/01/25/csharp-popups/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2025/01/25/csharp-efcore/">EF Core 快速开始</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2025-01-25</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/csharp/">csharp</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/csharp/">csharp</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/asp-net/">asp.net</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/microsoft/">microsoft</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/ef-core/">ef core</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/dotnet/">dotnet</a></div></div><div class="post-content"><div class="main-content content"><h1 id="EF-Core-快速开始"><a href="#EF-Core-快速开始" class="headerlink" title="EF Core 快速开始"></a>EF Core 快速开始</h1><h2 id="安装ef包"><a href="#安装ef包" class="headerlink" title="安装ef包"></a>安装ef包</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.EntityFrameworkCore.Sqlite</span><br><span class="line">Microsoft.EntityFrameworkCore.Design</span><br></pre></td></tr></table></figure>

<p>注意不要安装成<code>Microsoft.EntityFrameworkCore.Sqlite.Core</code>最后带<strong>core</strong>结尾的不是。</p>
<h2 id="实体模型"><a href="#实体模型" class="headerlink" title="实体模型"></a>实体模型</h2><p>建个文件夹比如<strong>Db</strong>存放所有的实体模型。数据库Context类如下</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">EasyRepo.Db</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MainContext</span> : <span class="title">DbContext</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MainContext</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MainContext</span>(<span class="params">DbContextOptions&lt;MainContext&gt; options</span>) : <span class="title">base</span>(<span class="params">options</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> DbSet&lt;ItemCategory&gt; ItemCategories &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> DbSet&lt;ItemProvider&gt; ItemProviders &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> DbSet&lt;InputItem&gt; InputItems &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> DbSet&lt;OutputItem&gt; OutputItems &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnConfiguring</span>(<span class="params">DbContextOptionsBuilder optionsBuilder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!optionsBuilder.IsConfigured)</span><br><span class="line">            &#123;</span><br><span class="line">                optionsBuilder.UseSqlite(<span class="string">&quot;Data Source=data.db&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中一个实体类模板如下</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">EasyRepo.Db</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">InputItem</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">Key</span>]</span><br><span class="line">        [<span class="meta">DatabaseGenerated(DatabaseGeneratedOption.Identity)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> DateTime InputDate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        [<span class="meta">ForeignKey(<span class="string">&quot;CategoryId&quot;</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> ItemCategory Category &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        [<span class="meta">AllowNull</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Itemname &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        [<span class="meta">ForeignKey(<span class="string">&quot;ProviderId&quot;</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> ItemProvider Provider &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">decimal</span> Count &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">decimal</span> Price &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        [<span class="meta">AllowNull</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Note &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意数据库一个表的外键必须使用诸如<strong>CategoryId</strong>这样的命名方式，否则迁移会报错。</p>
<h2 id="迁移数据"><a href="#迁移数据" class="headerlink" title="迁移数据"></a>迁移数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 新建迁移</span><br><span class="line">dotnet ef migrations add InitialCreate</span><br><span class="line"></span><br><span class="line"># 开始创建数据库</span><br><span class="line">dotnet ef database update</span><br><span class="line"></span><br><span class="line"># 如果提示版本过低，升级 ef 工具版本</span><br><span class="line">dotnet tool update --global dotnet-ef</span><br></pre></td></tr></table></figure>

<h2 id="不使用依赖注入"><a href="#不使用依赖注入" class="headerlink" title="不使用依赖注入"></a>不使用依赖注入</h2><p>如果不用类似ASP.NET那样的依赖注入来使用数据库，需要在 DbContext 同级目录下创建一个 <code>DesignTimeDbContextFactory.cs</code> 类</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">EasyRepo.Db</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DesignTimeDbContextFactory</span> : <span class="title">IDesignTimeDbContextFactory</span>&lt;<span class="title">MainContext</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> MainContext <span class="title">CreateDbContext</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> optionsBuilder = <span class="keyword">new</span> DbContextOptionsBuilder&lt;MainContext&gt;();</span><br><span class="line">            optionsBuilder.UseSqlite(<span class="string">&quot;Data Source=data.db&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> MainContext(optionsBuilder.Options);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样让ef工具正确识别如何新建数据库。</p>
</div></div><a class="button-hover more" href="/2025/01/25/csharp-efcore/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2025/01/25/diy-mi-band-4/">小米手环 4 手动同步 bin 表盘</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2025-01-25</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/diy/">diy</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/electronics/">electronics</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/diy/">diy</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/mi/">mi</a></div></div><div class="post-content"><div class="main-content content"><h1 id="小米手环-4-手动同步-bin-表盘"><a href="#小米手环-4-手动同步-bin-表盘" class="headerlink" title="小米手环 4 手动同步 bin 表盘"></a>小米手环 4 手动同步 bin 表盘</h1><h2 id="方法一（不推荐）"><a href="#方法一（不推荐）" class="headerlink" title="方法一（不推荐）"></a>方法一（不推荐）</h2><h3 id="1-小米运动下载一个表盘"><a href="#1-小米运动下载一个表盘" class="headerlink" title="1. 小米运动下载一个表盘"></a>1. 小米运动下载一个表盘</h3><p>从小米运动里随便找个表盘，记住找的哪一个，然后同步</p>
<h3 id="2-替换文件"><a href="#2-替换文件" class="headerlink" title="2. 替换文件"></a>2. 替换文件</h3><p>在</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">此电脑\Redmi K30 Pro\内部存储设备\Android\data\com.xiaomi.hm.health\files\watch_skin_local</span><br></pre></td></tr></table></figure>

<p>内找到刚下载的表盘，表盘是一个文件夹，名字类似<code>7ec60bf34ee7258203b9379495505706</code></p>
<p>打开里面有缩略图</p>
<h3 id="3-再次同步"><a href="#3-再次同步" class="headerlink" title="3. 再次同步"></a>3. 再次同步</h3><p>将文件夹内的bin替换成下载的第三方bin，回到小米运动app，打开刚才下的表盘，点击立即同步</p>
<h2 id="方法二（推荐）"><a href="#方法二（推荐）" class="headerlink" title="方法二（推荐）"></a>方法二（推荐）</h2><p>手动构造表盘文件夹，先随便新建个文件夹</p>
<h3 id="1-XML"><a href="#1-XML" class="headerlink" title="1. XML"></a>1. XML</h3><p>在文件夹内创建<code>infos.xml</code> XML 文件</p>
<p>名称为 <code>infos.xml</code>注意是 <strong>infos</strong> 不是 <strong>info</strong> </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27; standalone=&#x27;yes&#x27; ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">watch_skin_info</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">info</span>&gt;</span>&#123;&quot;O00000oO&quot;:&quot;表盘名称&quot;,&quot;O00000oo&quot;:0,&quot;O0000O0o&quot;:103587,&quot;O0000OOo&quot;:0,&quot;O0000Oo&quot;:false&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">info</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">watch_skin_info</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-图片"><a href="#2-图片" class="headerlink" title="2. 图片"></a>2. 图片</h3><p>相同目录下放入一个 <code>120X240</code> 的<code>png</code>格式图片用于预览图</p>
<h3 id="3-bin"><a href="#3-bin" class="headerlink" title="3. bin"></a>3. bin</h3><p>相同目录下放入下载的bin文件</p>
<h3 id="4-打包"><a href="#4-打包" class="headerlink" title="4. 打包"></a>4. 打包</h3><p>以上所有三个文件放入同一文件夹，把这个文件夹放到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">此电脑\Redmi K30 Pro\内部存储设备\Android\data\com.xiaomi.hm.health\files\watch_skin_local</span><br></pre></td></tr></table></figure>

<h3 id="附：方法二自动打包，调用-aio-函数即可"><a href="#附：方法二自动打包，调用-aio-函数即可" class="headerlink" title="附：方法二自动打包，调用 aio 函数即可"></a>附：方法二自动打包，调用 <code>aio</code> 函数即可</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">从网上下载符合要求的图片和 bin 文件，打开此程序</span></span><br><span class="line"><span class="string">输入文件名后自动处理打包</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> PySimpleGUI <span class="keyword">as</span> sg</span><br><span class="line"></span><br><span class="line">HELP = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">从网上下载符合要求的图片和 bin 文件，</span></span><br><span class="line"><span class="string">并放在此程序所在的文件夹，</span></span><br><span class="line"><span class="string">打开此程序，输入一个自定义的名字</span></span><br><span class="line"><span class="string">此软件自动处理打包</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">XML = <span class="string">&quot;&quot;&quot;&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27; standalone=&#x27;yes&#x27; ?&gt;&lt;watch_skin_info&gt;&lt;info&gt;&#123;&quot;O00000oO&quot;:&quot;&#123;&#123;NAME&#125;&#125;&quot;,&quot;O00000oo&quot;:0,&quot;O0000O0o&quot;:103587,&quot;O0000OOo&quot;:0,&quot;O0000Oo&quot;:false&#125;&lt;/info&gt;&lt;/watch_skin_info&gt;&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_xml</span>(<span class="params">folder, name</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; generate the XML template and write it to XML file &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&#x27;<span class="subst">&#123;folder&#125;</span>/infos.xml&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(XML.replace(<span class="string">&#x27;&#123;&#123;NAME&#125;&#125;&#x27;</span>, name))</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">name_is_pic</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;check whether the file is picture</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    checks: &#x27;webp&#x27;, &#x27;jpg&#x27;, &#x27;jpeg&#x27;, &#x27;gif&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    ext = name.split(<span class="string">&#x27;.&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> ext <span class="keyword">in</span> &#123;<span class="string">&#x27;webp&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>&#125;:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_png</span>(<span class="params">folder</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; 把图片后缀改成png &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(folder):</span><br><span class="line">        <span class="comment"># base name</span></span><br><span class="line">        name_without_ext = file.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="comment"># is picture</span></span><br><span class="line">        <span class="keyword">if</span> name_is_pic(file):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[I] 转换图片: %s&#x27;</span> % file)</span><br><span class="line">            os.system(<span class="string">f&#x27;magick &quot;<span class="subst">&#123;folder&#125;</span>\\<span class="subst">&#123;file&#125;</span>&quot; &quot;<span class="subst">&#123;folder&#125;</span>\\<span class="subst">&#123;name_without_ext&#125;</span>.png&quot;&#x27;</span>)</span><br><span class="line">            <span class="comment"># list dirs again to check the num of png</span></span><br><span class="line">            pngs = [i <span class="keyword">for</span> i <span class="keyword">in</span> os.listdir(folder) <span class="keyword">if</span> i.endswith(<span class="string">&#x27;.png&#x27;</span>)]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(pngs) &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> pngs[<span class="number">1</span>:]:</span><br><span class="line">                    os.remove(<span class="string">f&#x27;<span class="subst">&#123;folder&#125;</span>\\<span class="subst">&#123;j&#125;</span>&#x27;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;[I] 删除: %s&#x27;</span> % j)</span><br><span class="line">            os.remove(<span class="string">f&#x27;<span class="subst">&#123;folder&#125;</span>\\<span class="subst">&#123;file&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[I] 删除: %s&#x27;</span> % file)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[X] 文件夹 %s 内没有图片文件。&#x27;</span> % folder)</span><br><span class="line">            </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aio</span>(<span class="params">skin_name</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    give me the skin name and i will do all things, </span></span><br><span class="line"><span class="string">    return a str describe the status</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    skin = <span class="string">&#x27;no&#x27;</span></span><br><span class="line">    pic = <span class="string">&#x27;no&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(skin_name):</span><br><span class="line">            os.mkdir(skin_name)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">for</span> this_folder_file <span class="keyword">in</span> os.listdir(<span class="string">&#x27;./&#x27;</span>):</span><br><span class="line">        <span class="comment"># find Bin file!</span></span><br><span class="line">        <span class="keyword">if</span> this_folder_file.endswith(<span class="string">&#x27;.bin&#x27;</span>):</span><br><span class="line">            skin = <span class="string">&#x27;yes&#x27;</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[I] 识别表盘：%s&#x27;</span> % this_folder_file)</span><br><span class="line">            bin_file = this_folder_file</span><br><span class="line">            <span class="comment"># move it</span></span><br><span class="line">            shutil.move(bin_file, <span class="string">f&#x27;<span class="subst">&#123;skin_name&#125;</span>/<span class="subst">&#123;bin_file&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="comment"># generate template</span></span><br><span class="line">            write_xml(skin_name, skin_name)</span><br><span class="line">            <span class="comment"># whether to download picture</span></span><br><span class="line">        <span class="keyword">elif</span> name_is_pic(this_folder_file):</span><br><span class="line">            pic = <span class="string">&#x27;yes&#x27;</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[I] 识别图片：%s&#x27;</span> % this_folder_file)</span><br><span class="line">            <span class="comment"># move the picture to the directory</span></span><br><span class="line">            shutil.move(this_folder_file, <span class="string">f&#x27;<span class="subst">&#123;skin_name&#125;</span>\\<span class="subst">&#123;this_folder_file&#125;</span>&#x27;</span>)</span><br><span class="line">            convert_png(skin_name)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&#x27;完成，检测到皮肤：<span class="subst">&#123;skin&#125;</span>，检测到图片：<span class="subst">&#123;pic&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gui</span>():</span><br><span class="line">    f = (<span class="string">&#x27;微软雅黑&#x27;</span>, <span class="number">16</span>)</span><br><span class="line">    sg.theme(<span class="string">&#x27;Dark&#x27;</span>)</span><br><span class="line">    layout = [</span><br><span class="line">        [sg.Text(<span class="string">&#x27;表盘名称&#x27;</span>, font=f),</span><br><span class="line">         sg.InputText(key=<span class="string">&#x27;-NAME-&#x27;</span>, font=f, size=(<span class="number">20</span>, <span class="number">1</span>))],</span><br><span class="line">        </span><br><span class="line">        [sg.Text(<span class="string">&#x27;Ready&#x27;</span>, key=<span class="string">&#x27;-STATUS-&#x27;</span>, size=(<span class="number">30</span>, <span class="number">1</span>),font=f)],</span><br><span class="line">        </span><br><span class="line">        [sg.Button(<span class="string">&#x27;生成！&#x27;</span>, font=f),</span><br><span class="line">         sg.Button(<span class="string">&#x27;退出&#x27;</span>, font=f), </span><br><span class="line">         sg.Button(<span class="string">&#x27;帮助&#x27;</span>, font=f)]</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    window = sg.Window(<span class="string">&#x27;小米手环4表盘生成器&#x27;</span>, layout)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        event, values = window.read()</span><br><span class="line">        <span class="built_in">print</span>(event, values)</span><br><span class="line">        <span class="keyword">if</span> event == sg.WIN_CLOSED <span class="keyword">or</span> event == <span class="string">&#x27;退出&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> event == <span class="string">&#x27;生成！&#x27;</span>:</span><br><span class="line">            text = values[<span class="string">&#x27;-NAME-&#x27;</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> text:</span><br><span class="line">                window[<span class="string">&#x27;-STATUS-&#x27;</span>].update(<span class="string">&#x27;Skin name is required!&#x27;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            output = aio(text)</span><br><span class="line">            window[<span class="string">&#x27;-STATUS-&#x27;</span>].update(output)</span><br><span class="line">        <span class="keyword">elif</span> event == <span class="string">&#x27;帮助&#x27;</span>:</span><br><span class="line">            sg.popup(<span class="string">&#x27;帮助&#x27;</span>, HELP, font=f)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># aio(&#x27;tttttttttttttt&#x27;)</span></span><br><span class="line">    <span class="comment"># convert_png(&#x27;ProstoFace Orange&#x27;)</span></span><br><span class="line">    gui()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</div></div><a class="button-hover more" href="/2025/01/25/diy-mi-band-4/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2025/01/24/robocopy-in-real-action/">Robocopy实战文件备份</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2025-01-24</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/software/">software</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/windows/">windows</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/robocopy/">robocopy</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/backup/">backup</a></div></div><div class="post-content"><div class="main-content content"><h1 id="Robocopy实战文件备份"><a href="#Robocopy实战文件备份" class="headerlink" title="Robocopy实战文件备份"></a>Robocopy实战文件备份</h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/robocopy">robocopy | Microsoft Docs</a></p>
<p>robocopy 是 windows 系统自带的一个强大的命令行文件夹&#x2F;文件复制工具，它有非常多的参数可以配置。在数据同步中，robocopy 可用于编写自动同步脚本，如镜像同步目录 a 到目录 b，或增量同步 a 到 b 等，适合作为数据备份脚本。</p>
<h2 id="🔍robocopy-语法"><a href="#🔍robocopy-语法" class="headerlink" title="🔍robocopy 语法"></a>🔍robocopy 语法</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">robocopy &lt;source&gt; &lt;destination&gt; [&lt;file&gt;[ ...]] [&lt;options&gt;]</span><br><span class="line"></span><br><span class="line">robocopy  原路径  目标路径  [文件[ ...]]  [选项]</span><br><span class="line"></span><br><span class="line">如果路径中有空格，路径需要用英文引号包围。如 &quot;D:\my folder&quot; 和 &quot;D:\his folder&quot;</span><br></pre></td></tr></table></figure>

<h2 id="🚀命令行参数速查"><a href="#🚀命令行参数速查" class="headerlink" title="🚀命令行参数速查"></a>🚀命令行参数速查</h2><h3 id="S"><a href="#S" class="headerlink" title="&#x2F;S"></a>&#x2F;S</h3><p><strong>常用于不希望删除目标目录的备份方式</strong></p>
<p>使用 <code>/s</code> 来完整复制子目录，相当于直接两个文件夹之间复制粘贴，也相当于 Linux 上的递归复制；</p>
<p>相同文件，被源目录替换；源目录多的文件，目标目录不受影响；</p>
<p>例：模拟把 D:\a 文件夹内所有文件复制，粘贴到 D:\b 文件夹下，并替换同名文件，&#x2F;MT:1 参数后面说明。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">robocopy &quot;D:\a&quot; &quot;D:\b&quot; /S /MT:1</span><br></pre></td></tr></table></figure>

<h3 id="B"><a href="#B" class="headerlink" title="&#x2F;B"></a>&#x2F;B</h3><p><strong>不常用</strong>；</p>
<p>使用 <code>/b</code> 在备份模式下复制文件。 备份模式允许 Robocopy (ACL) 替代文件和文件夹权限设置。 这样，就可以复制你可能无权访问的文件，前提是该文件在具有足够权限的帐户下运行；</p>
<h3 id="MIR"><a href="#MIR" class="headerlink" title="&#x2F;MIR"></a>&#x2F;MIR</h3><p><strong>常用于镜像备份文件夹</strong>，目标文件夹会与源文件夹保持一致。</p>
<p>使用 <code>/mir</code> 来镜像复制，将此选项与 <strong>&#x2F;e</strong> 选项和目标目录结合使用，覆盖目标目录安全设置。</p>
<p>例：模拟把 D:\a 文件夹内所有文件复制，粘贴到 D:\b 文件夹下，并替换同名文件，并删除 b 内的多余文件。相当于让 b 完全保持与 a 相同的文件结构。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">robocopy &quot;D:\a&quot; &quot;D:\b&quot; /MIR /MT:1</span><br></pre></td></tr></table></figure>

<h3 id="MT"><a href="#MT" class="headerlink" title="&#x2F;MT"></a>&#x2F;MT</h3><p>使用 <code>/mt:2</code> 指定复制时线程数为 2；</p>
<p><font color="red"><strong>重要：</strong></font> <strong>在一切机械硬盘，无论CMR垂直还是SMR叠瓦，都应当使用 &#x2F;MT:1 开启单线程写入</strong>；固态硬盘也推荐使用此参数。对于SMR叠瓦盘，不开启 &#x2F;MT:1 的默认 8 线程写入会大幅降低硬盘寿命；</p>
<h3 id="COPY"><a href="#COPY" class="headerlink" title="&#x2F;COPY"></a>&#x2F;COPY</h3><p><strong>若不希望用管理员身份执行robocopy，可添加 &#x2F;COPY:DT 参数</strong>，避免复制文件属性</p>
<p>使用 <code>/copy:flag</code> 指定要复制的文件属性。 此选项的有效值为：<strong>D</strong> - 数据<strong>A</strong> - 属性<strong>T</strong> - 时间戳<strong>S</strong> - NTFS 访问控制列表 (ACL)<strong>O</strong> - 所有者信息<strong>U</strong> - 审核信息此选项的默认值为 <strong>DAT</strong> (数据、属性和时间戳) 。</p>
<h2 id="📝重要规则-必读"><a href="#📝重要规则-必读" class="headerlink" title="📝重要规则(必读)"></a>📝重要规则(必读)</h2><p><font color="red"><strong>下面这些非常重要</strong></font></p>
<ul>
<li>在一切机械硬盘，无论CMR垂直还是SMR叠瓦，都必须添加 **&#x2F;MT:1 **参数开启单线程写入；</li>
<li>使用批处理时，文件编码<strong>必须为 ANSI, GBK 中的一种</strong>（GBK 和 ANSI 在 Windows 上等价）。</li>
<li><strong>使用管理员权限</strong>执行 robocopy 命令，或者使用 &#x2F;COPY:DT 参数规避文件属性复制；</li>
<li>在执行前，仔细检查 robocopy 命令，尤其是开启了 <strong>&#x2F;MIR</strong> 参数的命令，防止意外删除文件。在命令运行时，命令行会实时输出当前正在复制的源目录。若发现正在一行行输出的目录是自己的目标目录，说明设置反了方向，立即按下 <strong>Ctrl+C</strong> 终止命令；</li>
</ul>
<h2 id="🌎关于编码"><a href="#🌎关于编码" class="headerlink" title="🌎关于编码"></a>🌎关于编码</h2><p>使用记事本的<code>另存为</code>功能，可以选择为 ANSI 编码；</p>
<p>使用专业编辑器如 VS Code, Sublime Text, Notepad++ 等，则设置为 GBK 编码（不是 GB2312）。</p>
<p>若自己编写命令生成软件，则生成的批处理必须使用 GBK。</p>
<p>如在 Python 内通过向 open() 函数传递 <code>encoding=&quot;gbk&quot;</code> 来指名编码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;自动生成.bat&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;gbk&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&#x27;robocopy命令字符串&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>若在 C# 内，使用如下代码：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line">Encoding.RegisterProvider(CodePagesEncodingProvider.Instance);</span><br><span class="line"><span class="built_in">string</span> finalCmd = <span class="string">&quot;robocopy命令字符串&quot;</span>;</span><br><span class="line">System.IO.File.WriteAllText(<span class="string">&quot;自动生成.bat&quot;</span>, finalCmd, Encoding.GetEncoding(<span class="string">&quot;GBK&quot;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="🗡️数据同步实战"><a href="#🗡️数据同步实战" class="headerlink" title="🗡️数据同步实战"></a>🗡️数据同步实战</h2><h3 id="文件夹单向同步"><a href="#文件夹单向同步" class="headerlink" title="文件夹单向同步"></a>文件夹单向同步</h3><p>例如，把 <code>D:\test</code> 镜像同步到 <code>E:\test</code> 下，这将保证 E:\test 与 D:\test 完全一致，来自 D 的文件将覆盖 E 的文件，E 中多余的文件将被删除，适用于文件夹的单向同步。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">robocopy &quot;D:\test&quot; &quot;E:\test&quot; /MIR /MT:1</span><br></pre></td></tr></table></figure>

<h3 id="文件夹同步到冷备份硬盘"><a href="#文件夹同步到冷备份硬盘" class="headerlink" title="文件夹同步到冷备份硬盘"></a>文件夹同步到冷备份硬盘</h3><p>把 <code>D:\test</code> 镜像同步到 <code>E:\test</code> 下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">robocopy &quot;D:\test&quot; &quot;E:\test&quot; /MIR /MT:1</span><br></pre></td></tr></table></figure>

<h3 id="文件夹普通复制备份"><a href="#文件夹普通复制备份" class="headerlink" title="文件夹普通复制备份"></a>文件夹普通复制备份</h3><p>把 <code>D:\test</code> 普通同步到 <code>E:\test</code> 下，不删除不同的文件，等价于复制时选择替换重名文件 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">robocopy &quot;D:\test&quot; &quot;E:\test&quot; /S /MT:1</span><br></pre></td></tr></table></figure>

<h3 id="不复制文件的属性"><a href="#不复制文件的属性" class="headerlink" title="不复制文件的属性"></a>不复制文件的属性</h3><p>把 <code>D:\test</code> 镜像同步到 <code>E:\test</code> 下，使用 <code>/COPY:DT</code> 不保留文件的属性，适用于不使用管理员身份运行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">robocopy &quot;D:\test&quot; &quot;E:\test&quot; /MIR /COPY:DT /MT:1</span><br></pre></td></tr></table></figure>

<p>使用以上命令时，可能遇到<strong>文件属性</strong>和<strong>无法找到文件</strong>的问题，如遇到则仍然使用<strong>管理员身份</strong>运行即可解决。</p>
<h2 id="部分选项"><a href="#部分选项" class="headerlink" title="部分选项"></a>部分选项</h2><table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&#x2F;s</td>
<td align="left">复制子目录。 此选项自动排除空目录。</td>
</tr>
<tr>
<td align="left">&#x2F;e</td>
<td align="left">复制子目录。 此选项自动包括空目录。</td>
</tr>
<tr>
<td align="left">&#x2F;lev：<code>&lt;n&gt;</code></td>
<td align="left">仅复制源目录树的前 <em>n</em> 个级别。</td>
</tr>
<tr>
<td align="left">&#x2F;z</td>
<td align="left">以可重启模式复制文件。 在可重启模式下，如果文件副本中断，Robocopy 可以选取它离开的位置，而不是重新复制整个文件。</td>
</tr>
<tr>
<td align="left">&#x2F;b</td>
<td align="left">在备份模式下复制文件。 备份模式允许 Robocopy (ACL) 替代文件和文件夹权限设置。 这样，就可以复制你可能无权访问的文件，前提是该文件在具有足够权限的帐户下运行。</td>
</tr>
<tr>
<td align="left">&#x2F;zb</td>
<td align="left">以可重启模式复制文件。 如果文件访问被拒绝，请切换到备份模式。</td>
</tr>
<tr>
<td align="left">&#x2F;j</td>
<td align="left">使用建议用于大型文件) 使用无缓冲区 I&#x2F;O (的副本。</td>
</tr>
<tr>
<td align="left">&#x2F;efsraw</td>
<td align="left">复制 EFS RAW 模式下的所有加密文件。</td>
</tr>
<tr>
<td align="left">&#x2F;copy：<code>&lt;copyflags&gt;</code></td>
<td align="left">指定要复制的文件属性。 此选项的有效值为：<strong>D</strong> - 数据<strong>A</strong> - 属性<strong>T</strong> - 时间戳<strong>S</strong> - NTFS 访问控制列表 (ACL)<strong>O</strong> - 所有者信息<strong>U</strong> - 审核信息此选项的默认值为 <strong>DAT</strong> (数据、属性和时间戳) 。</td>
</tr>
<tr>
<td align="left">&#x2F;dcopy：<code>&lt;copyflags&gt;</code></td>
<td align="left">指定要在目录中复制的内容。 此选项的有效值为：<strong>D</strong> - 数据<strong>A</strong> - 属性<strong>T</strong> - 时间戳此选项的默认值为 <strong>DA</strong> (数据和属性) 。</td>
</tr>
<tr>
<td align="left">&#x2F;秒</td>
<td align="left">复制安全 (等效 <strong>于 &#x2F;copy：DATS</strong>) 的文件。</td>
</tr>
<tr>
<td align="left">&#x2F;copyall</td>
<td align="left">复制与 <strong>&#x2F;copy：DATSOU</strong>) 等效的所有文件信息 (。</td>
</tr>
<tr>
<td align="left">&#x2F;nocopy</td>
<td align="left">复制任何文件信息， (<strong>&#x2F;purge</strong>) 很有用。</td>
</tr>
<tr>
<td align="left">&#x2F;secfix</td>
<td align="left">修复了所有文件的文件安全性，甚至跳过了这些文件。</td>
</tr>
<tr>
<td align="left">&#x2F;timfix</td>
<td align="left">修复了所有文件的文件时间，甚至跳过了这些文件。</td>
</tr>
<tr>
<td align="left">&#x2F;purge</td>
<td align="left">删除源中不再存在的目标文件和目录。 将此选项与 <strong>&#x2F;e</strong> 选项和目标目录结合使用，允许不覆盖目标目录安全设置。</td>
</tr>
<tr>
<td align="left">&#x2F;mir</td>
<td align="left">镜像与 <strong>&#x2F;e</strong> 和 <strong>&#x2F;purge</strong>) 等效的目录树 (。 将此选项与 <strong>&#x2F;e</strong> 选项和目标目录结合使用，覆盖目标目录安全设置。</td>
</tr>
<tr>
<td align="left">&#x2F;mov</td>
<td align="left">移动文件，并在复制文件后从源中删除这些文件。</td>
</tr>
<tr>
<td align="left">&#x2F;move</td>
<td align="left">移动文件和目录，并在复制这些文件和目录后从源中删除它们。</td>
</tr>
<tr>
<td align="left">&#x2F;a+：[RASHCNET]</td>
<td align="left">将指定的属性添加到复制的文件。 此选项的有效值为：<strong>R</strong> - 只读<strong>A</strong> - 存档<strong>S</strong> - 系统<strong>H</strong> - 隐藏<strong>C</strong> - 压缩<strong>N</strong> - 未编制索引的内容<strong>E</strong> - 加密<strong>T</strong> - 临时</td>
</tr>
<tr>
<td align="left">&#x2F;a-：[RASHCNET]</td>
<td align="left">从复制的文件中删除指定的属性。 此选项的有效值为：<strong>R</strong> - 只读<strong>A</strong> - 存档<strong>S</strong> - 系统<strong>H</strong> - 隐藏<strong>C</strong> - 压缩<strong>N</strong> - 未编制索引的内容<strong>E</strong> - 加密<strong>T</strong> - 临时</td>
</tr>
<tr>
<td align="left">&#x2F;create</td>
<td align="left">仅创建目录树和零长度文件。</td>
</tr>
<tr>
<td align="left">&#x2F;fat</td>
<td align="left">仅使用 8.3 个字符长度的 FAT 文件名创建目标文件。</td>
</tr>
<tr>
<td align="left">&#x2F;256</td>
<td align="left">关闭对超过 256 个字符的路径的支持。</td>
</tr>
<tr>
<td align="left">&#x2F;mon：<code>&lt;n&gt;</code></td>
<td align="left">监视源，并在检测到超过 <em>n 个</em> 更改时再次运行。</td>
</tr>
<tr>
<td align="left">&#x2F;mot：<code>&lt;m&gt;</code></td>
<td align="left">监视源，并在检测到更改时以 <em>m</em> 分钟为单位再次运行。</td>
</tr>
<tr>
<td align="left">&#x2F;mt<code>[:n]</code></td>
<td align="left">使用 <em>n</em> 个线程创建多线程副本。 <em>n</em> 必须是介于 1 和 128 之间的整数。 <em>n</em> 的默认值为 8。 为了提高性能，请使用 <strong>&#x2F;log</strong> 选项重定向输出。<strong>&#x2F;mt</strong> 参数不能与 <strong>&#x2F;ipg</strong> 和 <strong>&#x2F;efsraw</strong> 参数一起使用。</td>
</tr>
<tr>
<td align="left">&#x2F;rh：hhmm-hhmm</td>
<td align="left">指定可以启动新副本的运行时间。</td>
</tr>
<tr>
<td align="left">&#x2F;pf</td>
<td align="left">检查每个文件的运行时间， (不按传递) 。</td>
</tr>
<tr>
<td align="left">&#x2F;ipg：n</td>
<td align="left">指定数据包间差距，以在慢速线路上释放带宽。</td>
</tr>
<tr>
<td align="left">&#x2F;sj</td>
<td align="left">将连接 (软链接) 复制到目标路径而不是链接目标。</td>
</tr>
<tr>
<td align="left">&#x2F;sl</td>
<td align="left">不要关注符号链接，而是创建链接的副本。</td>
</tr>
<tr>
<td align="left">&#x2F;nodcopy</td>
<td align="left">(默认 <strong>&#x2F;dcopy：DA</strong>) 不复制任何目录信息。</td>
</tr>
<tr>
<td align="left">&#x2F;nooffload</td>
<td align="left">在不使用 Windows 复制卸载机制的情况下复制文件。</td>
</tr>
<tr>
<td align="left">&#x2F;compress</td>
<td align="left">请求文件传输期间的网络压缩（如果适用）。</td>
</tr>
</tbody></table>
<h2 id="退出-返回-代码"><a href="#退出-返回-代码" class="headerlink" title="退出 (返回) 代码"></a>退出 (返回) 代码</h2><table>
<thead>
<tr>
<th align="left">Value</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">未复制任何文件。 未遇到任何失败。 没有不匹配的文件。 目标目录中已存在这些文件;因此，跳过了复制操作。</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">已成功复制所有文件。</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">目标目录中存在一些其他文件，这些文件不在源目录中。 未复制任何文件。</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">复制了一些文件。 存在其他文件。 未遇到任何失败。</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">复制了一些文件。 某些文件不匹配。 未遇到任何失败。</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">存在其他文件和不匹配的文件。 未复制任何文件，也不会遇到任何故障。 这意味着文件已存在于目标目录中。</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left">文件已复制，存在文件不匹配，并且存在其他文件。</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left">多个文件未复制。</td>
</tr>
</tbody></table>
<h2 id="附：自动管理员身份运行"><a href="#附：自动管理员身份运行" class="headerlink" title="附：自动管理员身份运行"></a>附：自动管理员身份运行</h2><p>将以下命令复制到一个 bat 文件中，双击即可管理员身份运行。注意用 ANSI 或者 GBK 编码批处理文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">rem ============固定模板1开始============</span><br><span class="line">@ECHO OFF</span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line">PUSHD %~DP0 &amp; cd /d &quot;%~dp0&quot;</span><br><span class="line">%1 %2</span><br><span class="line">mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;%~s0&quot;,&quot;goto :target&quot;,&quot;&quot;,&quot;runas&quot;,1)(window.close)&amp;goto :eof</span><br><span class="line">:target</span><br><span class="line">rem ============固定模板1结束============</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">robocopy &quot;F:\转移文件\to&quot; &quot;F:\转移文件\from&quot; /MIR /MT:1</span><br><span class="line">robocopy &quot;F:\转移文件\to1&quot; &quot;F:\转移文件\from1&quot; /MIR /MT:1</span><br><span class="line">echo 所有目录均完成同步</span><br><span class="line"></span><br><span class="line">rem ============固定模板2开始============</span><br><span class="line">pause &gt; nul</span><br><span class="line">exit</span><br><span class="line">rem ============固定模板2结束============</span><br></pre></td></tr></table></figure>

</div></div><a class="button-hover more" href="/2025/01/24/robocopy-in-real-action/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2025/01/24/git-commit-standard/">如何规范你的 Git commit</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2025-01-25</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/dev/">dev</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/git/">git</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/GitHub/">GitHub</a></div></div><div class="post-content"><div class="main-content content"><h1 id="如何规范你的Git-commit"><a href="#如何规范你的Git-commit" class="headerlink" title="如何规范你的Git commit"></a>如何规范你的Git commit</h1><p>本文为转载</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/182553920">如何规范你的Git commit？ - 知乎 (zhihu.com)</a></p>
<h2 id="规范梳理"><a href="#规范梳理" class="headerlink" title="规范梳理"></a>规范梳理</h2><p>初期我们在互联网上搜索了大量有关git commit规范的资料，但只有Angular规范是目前使用最广的写法，比较合理和系统化，并且有配套的工具（IDEA就有插件支持这种写法）。最后综合阿里巴巴高德地图相关部门已有的规范总结出了一套git commit规范。</p>
<h3 id="commit-message格式"><a href="#commit-message格式" class="headerlink" title="commit message格式"></a>commit message格式</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br></pre></td></tr></table></figure>

<h3 id="type-必须"><a href="#type-必须" class="headerlink" title="type(必须)"></a>type(必须)</h3><p>用于说明git commit的类别，只允许使用下面的标识。</p>
<p><code>feat</code>：新功能（feature）。</p>
<p><code>fix/to</code>：修复bug，可以是QA发现的BUG，也可以是研发自己发现的BUG。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 示例1</span><br><span class="line">fix(global):修复checkbox不能复选的问题</span><br><span class="line"></span><br><span class="line">// 示例2 下面圆括号里的 common 为通用管理的名称</span><br><span class="line">fix(common): 修复字体过小的BUG，将通用管理下所有页面的默认字体大小修改为 14px</span><br><span class="line"></span><br><span class="line">// 示例3</span><br><span class="line">fix: value.length -&gt; values.length</span><br></pre></td></tr></table></figure>

<ul>
<li>fix：产生diff并自动修复此问题。适合于一次提交直接修复问题</li>
<li>to：只产生diff不自动修复此问题。适合于多次提交。最终修复问题提交时使用fix</li>
</ul>
<p><code>docs</code>：文档（documentation）。</p>
<p><code>style</code>：格式（不影响代码运行的变动）。</p>
<p><code>refactor</code>：重构（即不是新增功能，也不是修改bug的代码变动）。</p>
<p><code>perf</code>：优化相关，比如提升性能、体验。</p>
<p><code>test</code>：增加测试。</p>
<p><code>chore</code>：构建过程或辅助工具的变动。</p>
<p><code>revert</code>：回滚到上一个版本。</p>
<p><code>merge</code>：代码合并。</p>
<p><code>sync</code>：同步主线或分支的Bug。</p>
<h3 id="scope-可选"><a href="#scope-可选" class="headerlink" title="scope(可选)"></a>scope(可选)</h3><p>scope用于说明 commit 影响的范围，比如数据层、控制层、视图层等等，视项目不同而不同。</p>
<p>例如在Angular，可以是location，browser，compile，compile，rootScope， ngHref，ngClick，ngView等。如果你的修改影响了不止一个scope，你可以使用*代替。</p>
<h3 id="subject-必须"><a href="#subject-必须" class="headerlink" title="subject(必须)"></a>subject(必须)</h3><p>subject是commit目的的简短描述，不超过50个字符。</p>
<ul>
<li>结尾不加句号或其他标点符号。</li>
<li>根据以上规范git commit message将是如下的格式：</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fix(DAO):用户查询缺少username属性 </span><br><span class="line">feat(Controller):用户查询接口开发</span><br></pre></td></tr></table></figure>

<p>以上就是我们梳理的git commit规范，那么我们这样规范git commit到底有哪些好处呢？</p>
<ul>
<li>便于程序员对提交历史进行追溯，了解发生了什么情况。</li>
<li>一旦约束了commit message，意味着我们将慎重的进行每一次提交，不能再一股脑的把各种各样的改动都放在一个git commit里面，这样一来整个代码改动的历史也将更加清晰。</li>
<li>格式化的commit message才可以用于自动化输出Change log。</li>
</ul>
</div></div><a class="button-hover more" href="/2025/01/24/git-commit-standard/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2025/01/24/js-express-problems/">express.js 开发常见问题</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2025-01-24</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/javascript/">javascript</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/web/">web</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/express-js/">express.js</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/node-js/">node.js</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/javascript/">javascript</a></div></div><div class="post-content"><div class="main-content content"><h1 id="express-js-开发常见问题"><a href="#express-js-开发常见问题" class="headerlink" title="express.js 开发常见问题"></a>express.js 开发常见问题</h1><h2 id="无法访问css、js等"><a href="#无法访问css、js等" class="headerlink" title="无法访问css、js等"></a>无法访问css、js等</h2><p>添加静态资源文件夹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)));</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;public&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;./public&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;./&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;.&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br></pre></td></tr></table></figure>

<h2 id="允许跨域"><a href="#允许跨域" class="headerlink" title="允许跨域"></a>允许跨域</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;*&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">	res.<span class="title function_">header</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">	res.<span class="title function_">header</span>(<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="string">&#x27;X-Requested-With,Content-Type&#x27;</span>)</span><br><span class="line">	res.<span class="title function_">header</span>(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="string">&#x27;GET,POST,OPTIONS&#x27;</span>)</span><br><span class="line">	<span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="本机IP地址"><a href="#本机IP地址" class="headerlink" title="本机IP地址"></a>本机IP地址</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取当前机器的ip地址</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getIpAddress</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> ifaces = os.<span class="title function_">networkInterfaces</span>()</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> dev <span class="keyword">in</span> ifaces) &#123;</span><br><span class="line">		<span class="keyword">let</span> iface = ifaces[dev]</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; iface.<span class="property">length</span>; i++) &#123;</span><br><span class="line">			<span class="keyword">let</span> &#123; family, address, internal &#125; = iface[i]</span><br><span class="line">			<span class="keyword">if</span> (family === <span class="string">&#x27;IPv4&#x27;</span> &amp;&amp; address !== <span class="string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; !internal) &#123;</span><br><span class="line">				<span class="keyword">return</span> address</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二维码命令行打印"><a href="#二维码命令行打印" class="headerlink" title="二维码命令行打印"></a>二维码命令行打印</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> qrcode = <span class="built_in">require</span>(<span class="string">&#x27;qrcode-terminal&#x27;</span>)</span><br><span class="line"></span><br><span class="line">qrcode.<span class="title function_">generate</span>(<span class="string">`http://<span class="subst">$&#123;ip&#125;</span>:<span class="subst">$&#123;PORT&#125;</span>`</span>, &#123; <span class="attr">small</span>: <span class="literal">true</span> &#125;)</span><br></pre></td></tr></table></figure>

<h2 id="局域网无法访问"><a href="#局域网无法访问" class="headerlink" title="局域网无法访问"></a>局域网无法访问</h2><p>关闭系统防火墙，设置windows「专有网络」</p>
</div></div><a class="button-hover more" href="/2025/01/24/js-express-problems/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2025/01/24/edge-gray-video/">edge浏览器非全屏看视频变灰</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2025-01-24</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/software/">software</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/microsoft/">microsoft</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/edge/">edge</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/video/">video</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/internet/">internet</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/troubleshoot/">troubleshoot</a></div></div><div class="post-content"><div class="main-content content"><h1 id="edge浏览器非全屏看视频变灰"><a href="#edge浏览器非全屏看视频变灰" class="headerlink" title="edge浏览器非全屏看视频变灰"></a>edge浏览器非全屏看视频变灰</h1><p>在线观看非全屏视频的时候，点击播放头两秒是正常的，紧接着就蒙上一层灰一样。然后点击其他标签页又切回来，又一个循环。</p>
<h2 id="D3D11on12"><a href="#D3D11on12" class="headerlink" title="D3D11on12"></a>D3D11on12</h2><p>edge 地址框输入 <code>edge://flags</code> 接着搜索 <code>Choose ANGLE graphics backend</code> 设置为 <code>D3D11on12</code></p>
<p><strong>注意：经过实测这个办法会导致浏览器意外崩溃</strong>，设置为 D3D9 即可避免问题出现。</p>
<h2 id="关闭增强"><a href="#关闭增强" class="headerlink" title="关闭增强"></a>关闭增强</h2><p>进入设置 - 隐私、搜索和服务 - 关掉在Edge中增强图像</p>
<h2 id="B站弹幕发白"><a href="#B站弹幕发白" class="headerlink" title="B站弹幕发白"></a>B站弹幕发白</h2><p>在 NGA 搜到的某方法，应该同时适用于 edge 和 chrome（毕竟内核相同）。地址栏输入 <code>edge://flags</code> 或 chrome:&#x2F;&#x2F;flags，搜索 <code>D3</code> ，出现下面这个选项。默认是 Default，经逐个测试发现，只有 D3D9 能让弹幕恢复正常。</p>
<h2 id="文字发白"><a href="#文字发白" class="headerlink" title="文字发白"></a>文字发白</h2><p>若网页文本图标颜色也很暗淡灰白，edge 地址框输入<code>edge://flags</code>接着搜索<code>Force color</code>设置为 <code>sRGB</code></p>
</div></div><a class="button-hover more" href="/2025/01/24/edge-gray-video/#more">阅读全文</a></div></div><div id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fas fa-angle-right"></i></a></div></div></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fas fa-user"></i></span><span id="busuanzi_value_site_uv"></span><span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fas fa-eye"></i></span><span id="busuanzi_value_site_pv"></span><span></span></div><div class="copyright">&copy;2017 ～ 2025 By TaylorAndTony</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--><div class="search-dialog"><div id="algolia-search-title">Algolia</div><div class="search-close-button"><i class="fa fa-times"></i></div><!--div#current-refined-values--><!--div#clear-all--><div id="search-box"></div><!--div#refinement-list--><hr><div id="hits"></div><div id="algolia-pagination"></div></div><div class="search-mask"></div><script src="/js/search/algolia.js"></script></body></html>